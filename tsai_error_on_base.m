
As = [];
Bs = [];
Rx = quat2rotm([-0.6813727267000834, 0.29256406640798305, -0.40199667413880824, 0.5371556090533315]);
tx = [ 0.13175826886052527; 0.21919390815313747; -0.18162291432744282];
Tx = [Rx(1,1:3),tx(1,1);Rx(2,1:3),tx(2,1);Rx(3,1:3),tx(3,1);0,0,0,1];
RAs = [+0.61, +0.58, -0.24, +0.48;+0.70, +0.52, -0.36, +0.34;+0.55, +0.46, -0.36, +0.60;+0.72, +0.44, -0.13, +0.52;+0.47, +0.70, -0.34, +0.42;+0.66, +0.55, -0.30, +0.41;+0.58, +0.53, -0.30, +0.54;+0.67, +0.51, -0.18, +0.50;+0.54, +0.65, -0.29, +0.45;+0.61, +0.58, -0.24, +0.48;+0.61, +0.58, -0.24, +0.48;+0.61, +0.58, -0.24, +0.48;+0.61, +0.58, -0.24, +0.48;+0.61, +0.58, -0.24, +0.48];
tAs = [+0.66, -0.02, +0.68;+0.66, -0.02, +0.68;+0.66, -0.02, +0.68;+0.66, -0.02, +0.68;+0.66, -0.02, +0.68;+0.66, -0.02, +0.68;+0.66, -0.02, +0.68;+0.66, -0.02, +0.68;+0.66, -0.02, +0.68;+0.71, -0.02, +0.68;+0.61, -0.02, +0.68;+0.66, +0.08, +0.68;+0.66, -0.12, +0.68;+0.66, -0.02, +0.71];
RBs = [+0.78, -0.08, -0.38, +0.49;+0.81, -0.27, -0.33, +0.41;+0.83, -0.03, -0.18, +0.53;+0.65, -0.15, -0.36, +0.65;+0.87, +0.00, -0.39, +0.31;+0.79, -0.17, -0.36, +0.46;+0.81, -0.06, -0.29, +0.51;+0.72, -0.12, -0.38, +0.57;+0.83, -0.04, -0.39, +0.40;+0.78, -0.07, -0.39, +0.49;+0.78, -0.08, -0.39, +0.49;+0.78, -0.08, -0.39, +0.49;+0.78, -0.08, -0.39, +0.49;+0.78, -0.08, -0.39, +0.49];
tBs = [+0.63, +0.09, -0.10;+0.60, -0.10, +0.10;+0.54, +0.28, +0.08;+0.62, +0.08, -0.16;+0.63, +0.08, -0.05;+0.64, -0.01, -0.00;+0.60, +0.19, -0.01;+0.63, +0.09, -0.13;+0.63, +0.09, -0.08;+0.61, +0.12, -0.14;+0.64, +0.06, -0.06;+0.71, +0.06, -0.15;+0.54, +0.12, -0.06;+0.64, +0.12, -0.09];

for i= 1:length(RAs)
    ra = quat2rotm(RAs(i,:));
    As = [As;ra(1,1:3),tAs(i,1);ra(2,1:3),tAs(i,2);ra(3,1:3),tAs(i,3);0,0,0,1];
    rb = quat2rotm(RBs(i,:));
    Bs = [Bs;rb(1,1:3),tBs(i,1);rb(2,1:3),tBs(i,2);rb(3,1:3),tBs(i,3);0,0,0,1];
end

total_R = 0;
total_t = 0;
cnt = 0;
for i = 1:length(RAs)
    for j = i+1:length(RAs)
        RA = inv(As(4*j-3:4*j-1,1:3))*As(4*i-3:4*i-1,1:3);
        RB = Bs(4*j-3:4*j-1,1:3)*inv(Bs(4*i-3:4*i-1,1:3));
        eR = inv(RA*X(1:3,1:3))*X(1:3,1:3)*RB;
        total_R = power(norm(rotm2eul(eR)/pi*180),2) + total_R;
        cnt = cnt+1;
    end
end
total_R/cnt